<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Compta Express - Configuration | iArmy</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%23FF6B35'/><text x='50' y='68' font-family='Arial' font-size='55' font-weight='bold' fill='white' text-anchor='middle'>i</text></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Inter', sans-serif; }
    body { background: #0a0a0a; color: white; min-height: 100vh; }
    
    .logo-i {
      width: 36px; height: 36px;
      background: linear-gradient(135deg, #FF6B35 0%, #FF8B5E 100%);
      border-radius: 10px;
      display: flex; align-items: center; justify-content: center;
      font-weight: 800; font-size: 18px;
      transition: all 0.3s;
    }
    .logo-i:hover {
      transform: scale(1.1) rotate(-5deg);
      box-shadow: 0 0 30px rgba(255,107,53,0.5);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #FF6B35 0%, #FF8B5E 100%);
      padding: 14px 28px; border-radius: 12px; font-weight: 600;
      transition: all 0.3s; border: none; color: white; cursor: pointer;
    }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(255,107,53,0.3); }
    .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    
    .btn-secondary {
      background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
      padding: 14px 28px; border-radius: 12px; font-weight: 500;
      transition: all 0.3s; color: white; cursor: pointer;
    }
    .btn-secondary:hover { background: rgba(255,255,255,0.1); }
    
    .btn-google {
      background: white; color: #333;
      padding: 14px 28px; border-radius: 12px; font-weight: 500;
      transition: all 0.3s; border: none; cursor: pointer;
      display: flex; align-items: center; justify-content: center; gap: 10px;
    }
    .btn-google:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(255,255,255,0.1); }
    
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    
    .animate-fade-in { animation: fadeIn 0.5s ease-out; }
    .animate-slide-in { animation: slideIn 0.5s ease-out; }
    
    /* Sidebar */
    .sidebar {
      background: rgba(255,255,255,0.02);
      border-right: 1px solid rgba(255,255,255,0.05);
      width: 280px;
      min-height: 100vh;
      padding: 24px;
    }
    
    .step-item {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 16px;
      border-radius: 12px;
      margin-bottom: 8px;
      transition: all 0.3s;
      cursor: default;
    }
    .step-item.active {
      background: rgba(255,107,53,0.1);
    }
    .step-item.completed {
      opacity: 0.5;
    }
    .step-item.upcoming {
      opacity: 0.3;
    }
    
    .step-number {
      width: 32px; height: 32px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-weight: 600; font-size: 14px;
      background: rgba(255,255,255,0.05);
      border: 2px solid rgba(255,255,255,0.1);
      transition: all 0.3s;
    }
    .step-item.active .step-number {
      background: linear-gradient(135deg, #FF6B35, #FF8B5E);
      border-color: #FF6B35;
    }
    .step-item.completed .step-number {
      background: #22c55e;
      border-color: #22c55e;
    }
    
    .step-label {
      font-size: 14px;
      font-weight: 500;
      color: rgba(255,255,255,0.6);
    }
    .step-item.active .step-label {
      color: white;
    }
    
    /* Main Content */
    .main-content {
      flex: 1;
      padding: 40px;
      max-width: 700px;
      margin: 0 auto;
    }
    
    .step-content {
      display: none;
    }
    .step-content.active {
      display: block;
      animation: slideIn 0.4s ease-out;
    }
    
    /* Upload Zone */
    .upload-zone {
      border: 2px dashed rgba(255,255,255,0.15);
      border-radius: 20px;
      padding: 50px 30px;
      text-align: center;
      transition: all 0.3s;
      cursor: pointer;
      background: rgba(255,255,255,0.02);
    }
    .upload-zone:hover, .upload-zone.dragover {
      border-color: #FF6B35;
      background: rgba(255,107,53,0.05);
    }
    .upload-zone.dragover {
      transform: scale(1.02);
    }
    
    .upload-icon {
      width: 70px; height: 70px;
      background: linear-gradient(135deg, rgba(255,107,53,0.2), rgba(255,107,53,0.1));
      border-radius: 20px;
      display: flex; align-items: center; justify-content: center;
      font-size: 32px;
      margin: 0 auto 20px;
    }
    
    .file-types {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    .file-type {
      padding: 6px 14px;
      background: rgba(255,255,255,0.05);
      border-radius: 20px;
      font-size: 12px;
      color: rgba(255,255,255,0.5);
    }
    
    .divider {
      display: flex;
      align-items: center;
      gap: 20px;
      margin: 30px 0;
    }
    .divider-line {
      flex: 1;
      height: 1px;
      background: rgba(255,255,255,0.1);
    }
    .divider-text {
      color: rgba(255,255,255,0.3);
      font-size: 13px;
    }
    
    /* File Preview */
    .file-preview {
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 16px;
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 16px;
      margin-top: 20px;
    }
    .file-icon {
      width: 50px; height: 50px;
      background: linear-gradient(135deg, #0f9d58, #34a853);
      border-radius: 12px;
      display: flex; align-items: center; justify-content: center;
      font-size: 24px;
    }
    .file-info { flex: 1; }
    .file-name { font-weight: 600; margin-bottom: 4px; }
    .file-size { font-size: 13px; color: rgba(255,255,255,0.4); }
    .file-remove {
      width: 36px; height: 36px;
      background: rgba(239,68,68,0.1);
      border: none;
      border-radius: 10px;
      color: #ef4444;
      cursor: pointer;
      transition: all 0.2s;
    }
    .file-remove:hover { background: rgba(239,68,68,0.2); }
    
    /* Close Button */
    .close-btn {
      position: fixed;
      top: 24px; right: 24px;
      width: 44px; height: 44px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      color: white;
      z-index: 100;
    }
    .close-btn:hover {
      background: rgba(255,255,255,0.1);
      transform: rotate(90deg);
    }
    
    .gradient-text {
      background: linear-gradient(135deg, #FF6B35, #FF8B5E);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .sidebar { display: none; }
      .main-content { padding: 24px; }
    }
  </style>
</head>
<body>
  <div class="flex min-h-screen">
    <!-- Sidebar -->
    <aside class="sidebar">
      <a href="index.html" class="flex items-center gap-3 mb-10">
        <div class="logo-i">i</div>
        <span class="font-semibold">iArmy</span>
      </a>
      
      <div class="mb-6">
        <span class="text-xs text-white/40 uppercase tracking-wider">Configuration</span>
      </div>
      
      <div id="steps-nav">
        <div class="step-item active" data-step="1">
          <div class="step-number">1</div>
          <span class="step-label">Ton fichier</span>
        </div>
        <div class="step-item upcoming" data-step="2">
          <div class="step-number">2</div>
          <span class="step-label">Analyse</span>
        </div>
        <div class="step-item upcoming" data-step="3">
          <div class="step-number">3</div>
          <span class="step-label">Configuration</span>
        </div>
        <div class="step-item upcoming" data-step="4">
          <div class="step-number">4</div>
          <span class="step-label">Ton compte</span>
        </div>
        <div class="step-item upcoming" data-step="5">
          <div class="step-number">5</div>
          <span class="step-label">Telegram</span>
        </div>
      </div>
      
      <div class="mt-auto pt-10">
        <div class="text-xs text-white/30">
          üßæ Compta Express<br>
          <span class="text-white/20">v1.0</span>
        </div>
      </div>
    </aside>
    
    <!-- Main Content -->
    <main class="main-content">
      <!-- Close Button -->
      <a href="index.html" class="close-btn">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </a>
      
      <!-- Step 1: Upload -->
      <div class="step-content active" id="step-1">
        <div class="mb-2">
          <span class="text-white/40 text-sm">√âtape 1/5</span>
        </div>
        <h1 class="text-3xl font-bold mb-3">Comment tu g√®res ta compta ?</h1>
        <p class="text-white/50 mb-8">Envoie-nous ton fichier Excel actuel, on s'adapte √† toi.</p>
        
        <div class="upload-zone" id="upload-zone" onclick="document.getElementById('file-input').click()">
          <div class="upload-icon">üìÅ</div>
          <p class="text-lg font-medium mb-2">Glisse ton fichier ici</p>
          <p class="text-white/40 text-sm">ou clique pour parcourir</p>
          <div class="file-types">
            <span class="file-type">.xlsx</span>
            <span class="file-type">.xls</span>
            <span class="file-type">.csv</span>
          </div>
        </div>
        <input type="file" id="file-input" accept=".xlsx,.xls,.csv" class="hidden" onchange="handleFileSelect(event)">
        
        <div id="file-preview" class="hidden">
          <div class="file-preview">
            <div class="file-icon">üìä</div>
            <div class="file-info">
              <div class="file-name" id="file-name">fichier.xlsx</div>
              <div class="file-size" id="file-size">245 KB</div>
            </div>
            <button class="file-remove" onclick="removeFile()">‚úï</button>
          </div>
        </div>
        
        <div class="divider">
          <div class="divider-line"></div>
          <span class="divider-text">ou</span>
          <div class="divider-line"></div>
        </div>
        
        <button class="btn-google w-full" onclick="connectGoogle()">
          <svg width="20" height="20" viewBox="0 0 24 24">
            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
          </svg>
          Connecter Google Sheets
        </button>
        
        <p class="text-center text-white/30 text-xs mt-4">
          Ton fichier est en ligne ? Connecte-toi pour y acc√©der directement.
        </p>
        
        <div class="mt-10 flex justify-end">
          <button class="btn-primary" id="next-btn-1" onclick="nextStep(2)" disabled>
            Continuer ‚Üí
          </button>
        </div>
      </div>
      
      <!-- Step 2: Analyse -->
      <div class="step-content" id="step-2">
        <div class="mb-2">
          <span class="text-white/40 text-sm">√âtape 2/5</span>
        </div>
        <h1 class="text-3xl font-bold mb-3">Analyse en cours...</h1>
        <p class="text-white/50 mb-8">On regarde comment ton fichier est structur√©.</p>
        
        <div class="bg-white/5 rounded-2xl p-8 text-center">
          <div class="text-5xl mb-4 animate-pulse">üîç</div>
          <p class="text-white/60">D√©tection des colonnes...</p>
          <div class="mt-6 h-2 bg-white/10 rounded-full overflow-hidden max-w-xs mx-auto">
            <div class="h-full bg-gradient-to-r from-orange-500 to-orange-400 w-0 transition-all duration-1000" id="analysis-progress"></div>
          </div>
        </div>
      </div>
      
      <!-- Step 3: Config (placeholder) -->
      <div class="step-content" id="step-3">
        <div class="mb-2">
          <span class="text-white/40 text-sm">√âtape 3/5</span>
        </div>
        <h1 class="text-3xl font-bold mb-3">Configuration</h1>
        <p class="text-white/50 mb-8">On configure le robot selon tes besoins.</p>
        <!-- √Ä compl√©ter -->
      </div>
      
      <!-- Step 4: Account (placeholder) -->
      <div class="step-content" id="step-4">
        <div class="mb-2">
          <span class="text-white/40 text-sm">√âtape 4/5</span>
        </div>
        <h1 class="text-3xl font-bold mb-3">Cr√©e ton compte</h1>
        <p class="text-white/50 mb-8">Pour sauvegarder ta configuration.</p>
        <!-- √Ä compl√©ter -->
      </div>
      
      <!-- Step 5: Telegram (placeholder) -->
      <div class="step-content" id="step-5">
        <div class="mb-2">
          <span class="text-white/40 text-sm">√âtape 5/5</span>
        </div>
        <h1 class="text-3xl font-bold mb-3">Connecte Telegram</h1>
        <p class="text-white/50 mb-8">Derni√®re √©tape ! Lie ton compte Telegram.</p>
        <!-- √Ä compl√©ter -->
      </div>
    </main>
  </div>

  <script>
    let currentStep = 1;
    let selectedFile = null;
    
    // Drag & Drop
    const uploadZone = document.getElementById('upload-zone');
    
    uploadZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadZone.classList.add('dragover');
    });
    
    uploadZone.addEventListener('dragleave', () => {
      uploadZone.classList.remove('dragover');
    });
    
    uploadZone.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadZone.classList.remove('dragover');
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        handleFile(files[0]);
      }
    });
    
    function handleFileSelect(event) {
      const file = event.target.files[0];
      if (file) handleFile(file);
    }
    
    function handleFile(file) {
      const validTypes = ['.xlsx', '.xls', '.csv'];
      const ext = '.' + file.name.split('.').pop().toLowerCase();
      
      if (!validTypes.includes(ext)) {
        alert('Format non support√©. Utilise .xlsx, .xls ou .csv');
        return;
      }
      
      selectedFile = file;
      
      // Show preview
      document.getElementById('upload-zone').classList.add('hidden');
      document.getElementById('file-preview').classList.remove('hidden');
      document.getElementById('file-name').textContent = file.name;
      document.getElementById('file-size').textContent = formatFileSize(file.size);
      
      // Enable next button
      document.getElementById('next-btn-1').disabled = false;
    }
    
    function removeFile() {
      selectedFile = null;
      document.getElementById('upload-zone').classList.remove('hidden');
      document.getElementById('file-preview').classList.add('hidden');
      document.getElementById('file-input').value = '';
      document.getElementById('next-btn-1').disabled = true;
    }
    
    function formatFileSize(bytes) {
      if (bytes < 1024) return bytes + ' B';
      if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
      return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
    }
    
    function connectGoogle() {
      // TODO: Implement Google OAuth
      alert('Connexion Google Sheets bient√¥t disponible !');
    }
    
    function nextStep(step) {
      // Update sidebar
      document.querySelectorAll('.step-item').forEach((item, i) => {
        item.classList.remove('active', 'completed', 'upcoming');
        if (i + 1 < step) item.classList.add('completed');
        else if (i + 1 === step) item.classList.add('active');
        else item.classList.add('upcoming');
      });
      
      // Update content
      document.querySelectorAll('.step-content').forEach(content => {
        content.classList.remove('active');
      });
      document.getElementById(`step-${step}`).classList.add('active');
      
      currentStep = step;
      
      // Step 2: Simulate analysis
      if (step === 2) {
        setTimeout(() => {
          document.getElementById('analysis-progress').style.width = '100%';
        }, 100);
        
        setTimeout(() => {
          nextStep(3);
        }, 2500);
      }
    }
    
    function prevStep() {
      if (currentStep > 1) {
        nextStep(currentStep - 1);
      }
    }
  </script>
</body>
</html>
