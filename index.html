<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>iArmy - Une armÃ©e de robots pour ton quotidien</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%23FF6B35'/><text x='50' y='68' font-family='Arial' font-size='55' font-weight='bold' fill='white' text-anchor='middle'>i</text></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Space Grotesk', sans-serif; }
    body { background: #030303; color: white; min-height: 100vh; overflow-x: hidden; }
    
    /* Animated gradient background */
    .bg-gradient-animate {
      background: linear-gradient(135deg, #030303 0%, #0a0508 25%, #050808 50%, #080805 75%, #030303 100%);
      background-size: 400% 400%;
      animation: gradientShift 20s ease infinite;
    }
    @keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
    
    /* Floating orbs */
    .orb { position: fixed; border-radius: 50%; filter: blur(100px); opacity: 0.15; animation: float 15s ease-in-out infinite; pointer-events: none; z-index: 0; }
    .orb-1 { width: 500px; height: 500px; background: linear-gradient(135deg, #FF6B35, #FF8B5E); top: -250px; right: -150px; }
    .orb-2 { width: 400px; height: 400px; background: linear-gradient(135deg, #6B35FF, #8B5EFF); bottom: -200px; left: -150px; animation-delay: -7s; }
    .orb-3 { width: 250px; height: 250px; background: linear-gradient(135deg, #35FFB8, #5EFFD4); top: 40%; left: 40%; opacity: 0.08; animation-delay: -3s; }
    @keyframes float { 0%, 100% { transform: translate(0, 0) scale(1); } 33% { transform: translate(30px, -30px) scale(1.05); } 66% { transform: translate(-20px, 20px) scale(0.95); } }
    
    /* Glass effects */
    .glass { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.05); }
    .glass-card { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px); border: 1px solid rgba(255, 255, 255, 0.06); border-radius: 24px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5); transition: all 0.4s ease; }
    .glass-card:hover { background: rgba(255, 255, 255, 0.03); border-color: rgba(255, 255, 255, 0.1); transform: translateY(-4px); }
    
    /* Logo */
    .logo-i { width: 40px; height: 40px; background: linear-gradient(135deg, #FF6B35 0%, #FF8B5E 50%, #FFB088 100%); border-radius: 11px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 18px; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 4px 15px rgba(255, 107, 53, 0.25); }
    .logo-i:hover { transform: scale(1.1) rotate(-5deg); box-shadow: 0 8px 30px rgba(255, 107, 53, 0.4), 0 0 40px rgba(255, 107, 53, 0.2); }
    
    /* Buttons */
    .btn-primary { background: linear-gradient(135deg, #FF6B35, #FF8B5E); border: none; border-radius: 14px; padding: 14px 28px; color: white; font-weight: 600; cursor: pointer; position: relative; overflow: hidden; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(255, 107, 53, 0.25); }
    .btn-primary::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition: left 0.5s ease; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4); }
    .btn-primary:hover::before { left: 100%; }
    
    .btn-secondary { background: rgba(255, 255, 255, 0.04); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 14px; padding: 12px 24px; color: white; font-weight: 500; cursor: pointer; transition: all 0.3s ease; }
    .btn-secondary:hover { background: rgba(255, 255, 255, 0.08); border-color: rgba(255, 255, 255, 0.15); }
    
    /* Animations */
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    .animate-fade-in-up { animation: fadeInUp 0.6s ease-out forwards; }
    .animate-fade-in-down { animation: fadeInDown 0.5s ease-out forwards; }
    .delay-100 { animation-delay: 0.1s; opacity: 0; }
    .delay-200 { animation-delay: 0.2s; opacity: 0; }
    .delay-300 { animation-delay: 0.3s; opacity: 0; }
    
    /* iPhone mockup */
    .iphone { width: 180px; background: linear-gradient(145deg, #1a1a1a, #0a0a0a); border-radius: 32px; padding: 8px; box-shadow: 0 0 0 2px rgba(255,255,255,0.08), 0 30px 60px rgba(0,0,0,0.5); }
    .iphone-screen { background: #000; border-radius: 26px; overflow: hidden; }
    .iphone-notch { width: 80px; height: 22px; background: #000; border-radius: 0 0 14px 14px; margin: 0 auto; }
    
    /* Telegram UI */
    .telegram-header { background: rgba(28, 28, 30, 0.9); padding: 8px 12px; display: flex; align-items: center; gap: 8px; }
    .telegram-avatar { width: 28px; height: 28px; background: linear-gradient(135deg, #FF6B35, #FF8B5E); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 11px; }
    .telegram-name { font-size: 13px; font-weight: 600; }
    .telegram-status { font-size: 10px; color: #0a84ff; }
    .telegram-messages { background: #000; padding: 10px; min-height: 140px; display: flex; flex-direction: column; gap: 6px; }
    .msg { max-width: 85%; padding: 8px 12px; border-radius: 16px; font-size: 12px; line-height: 1.3; opacity: 0; transform: translateY(10px); transition: all 0.3s; }
    .msg.show { opacity: 1; transform: translateY(0); }
    .msg-user { background: #0a84ff; align-self: flex-end; border-bottom-right-radius: 4px; }
    .msg-bot { background: #2c2c2e; align-self: flex-start; border-bottom-left-radius: 4px; }
    .typing-indicator { display: flex; gap: 3px; padding: 10px 12px; background: #2c2c2e; border-radius: 16px; align-self: flex-start; opacity: 0; transition: opacity 0.2s; }
    .typing-indicator.show { opacity: 1; }
    .typing-indicator span { width: 5px; height: 5px; background: #666; border-radius: 50%; animation: typing 1.4s infinite; }
    .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
    .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes typing { 0%, 60%, 100% { opacity: 0.3; } 30% { opacity: 1; } }
    
    /* Google Sheet mockup */
    .sheet { background: #1a1a1a; border-radius: 12px; overflow: hidden; width: 160px; box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
    .sheet-header { background: #0d7a3f; padding: 6px 10px; display: flex; align-items: center; gap: 6px; }
    .sheet-icon { width: 16px; height: 16px; background: white; border-radius: 3px; display: flex; align-items: center; justify-content: center; }
    .sheet-title { font-size: 11px; font-weight: 500; }
    .sheet-grid { font-size: 10px; }
    .sheet-grid th, .sheet-grid td { padding: 4px 8px; border: 1px solid rgba(255,255,255,0.1); text-align: left; }
    .sheet-grid th { background: rgba(255,255,255,0.05); font-weight: 500; color: rgba(255,255,255,0.6); }
    .sheet-grid .amount { color: #4ade80; font-weight: 600; }
    .new-row { animation: rowHighlight 1s ease-out; }
    @keyframes rowHighlight { 0% { background: rgba(255,107,53,0.4); } 100% { background: transparent; } }
    
    /* Glide animation */
    .glide-container { position: relative; height: 20px; margin: 10px 0; }
    .glide-line { position: absolute; top: 50%; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, rgba(255,107,53,0.3), transparent); }
    .glide-logo { position: absolute; top: 50%; left: 0; transform: translateY(-50%); width: 24px; height: 24px; background: linear-gradient(135deg, #FF6B35, #FF8B5E); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 10px; opacity: 0; box-shadow: 0 0 20px rgba(255,107,53,0.5); }
    .glide-logo.animate { animation: glide 1.5s ease-in-out forwards; }
    @keyframes glide { 0% { left: 0; opacity: 0; } 15% { opacity: 1; } 85% { opacity: 1; } 100% { left: calc(100% - 24px); opacity: 0; } }
    
    /* Modal */
    .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); z-index: 100; opacity: 0; pointer-events: none; transition: opacity 0.3s; }
    .modal-backdrop.active { opacity: 1; pointer-events: all; }
    .modal-content { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.9); background: rgba(20, 20, 20, 0.95); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.08); border-radius: 24px; padding: 32px; width: 90%; max-width: 400px; z-index: 101; opacity: 0; pointer-events: none; transition: all 0.3s; }
    .modal-content.active { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: all; }
    .modal-close { position: absolute; top: 16px; right: 16px; width: 32px; height: 32px; background: rgba(255,255,255,0.05); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; }
    .modal-close:hover { background: rgba(255,255,255,0.1); transform: rotate(90deg); }
    
    /* Inputs */
    .input-field { background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; padding: 14px 16px; color: white; width: 100%; font-size: 15px; transition: all 0.2s; }
    .input-field:focus { outline: none; border-color: rgba(255,107,53,0.4); box-shadow: 0 0 0 3px rgba(255,107,53,0.1); }
    .input-field::placeholder { color: rgba(255,255,255,0.25); }
    
    /* Tabs */
    .tab-container { display: flex; background: rgba(255,255,255,0.03); border-radius: 12px; padding: 4px; margin-bottom: 24px; }
    .tab-btn { flex: 1; padding: 10px; border-radius: 10px; font-size: 14px; font-weight: 500; color: rgba(255,255,255,0.5); background: transparent; border: none; cursor: pointer; transition: all 0.2s; }
    .tab-btn.active { background: rgba(255,107,53,0.2); color: #FF6B35; }
    
    /* Error */
    .error-msg { background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.2); border-radius: 10px; padding: 10px 14px; color: #ef4444; font-size: 13px; display: none; }
    .error-msg.show { display: block; }
    
    /* Mobile hero */
    @media (max-width: 768px) {
      .hero-demo { flex-direction: column; gap: 20px; }
      .iphone { width: 140px; }
      .sheet { width: 140px; }
      .glide-container { display: none; }
      .orb { opacity: 0.1; }
    }
  </style>
</head>
<body class="bg-gradient-animate">
  <!-- Orbs -->
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>

  <!-- Nav -->
  <nav class="glass fixed top-0 left-0 right-0 z-50 animate-fade-in-down">
    <div class="max-w-6xl mx-auto px-6 py-4 flex items-center justify-between">
      <a href="index.html" class="flex items-center gap-3">
        <div class="logo-i">i</div>
        <span class="font-semibold text-lg hidden sm:block">iArmy</span>
      </a>
      <div id="auth-buttons"></div>
    </div>
  </nav>

  <!-- Hero -->
  <section class="min-h-screen flex items-center justify-center px-6 pt-24 pb-12 relative z-10">
    <div class="max-w-6xl mx-auto">
      <div class="grid lg:grid-cols-2 gap-12 items-center">
        <!-- Left: Text -->
        <div class="text-center lg:text-left">
          <div class="inline-block px-4 py-2 rounded-full bg-gradient-to-r from-orange-500/10 to-orange-500/5 border border-orange-500/20 text-orange-400 text-sm mb-6 animate-fade-in-up">
            ðŸ¤– Robot comptable IA
          </div>
          <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold mb-6 animate-fade-in-up delay-100 leading-tight">
            Ta compta sur<br><span class="bg-gradient-to-r from-orange-400 to-orange-500 bg-clip-text text-transparent">Telegram</span>
          </h1>
          <p class="text-lg text-white/50 mb-8 animate-fade-in-up delay-200 max-w-lg mx-auto lg:mx-0">
            Envoie tes recettes par message, le robot remplit ton Google Sheet automatiquement.
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start animate-fade-in-up delay-300">
            <button onclick="launchRobot()" class="btn-primary text-lg px-8 py-4">
              Lancer mon robot â†’
            </button>
          </div>
          <p class="text-white/30 text-sm mt-6 animate-fade-in-up delay-300">7 jours d'essai gratuit â€¢ Sans CB</p>
        </div>
        
        <!-- Right: Demo -->
        <div class="flex justify-center animate-fade-in-up delay-200">
          <div class="hero-demo flex items-center gap-6">
            <!-- iPhone -->
            <div class="iphone">
              <div class="iphone-screen">
                <div class="iphone-notch"></div>
                <div class="telegram-header">
                  <span style="color:#0a84ff;font-size:16px;">â€¹</span>
                  <div class="telegram-avatar">i</div>
                  <div>
                    <div class="telegram-name">iArmy Compta</div>
                    <div class="telegram-status">en ligne</div>
                  </div>
                </div>
                <div class="telegram-messages" id="telegram-messages">
                  <div class="typing-indicator" id="typing">
                    <span></span><span></span><span></span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Glide -->
            <div class="glide-container hidden sm:block">
              <div class="glide-line"></div>
              <div class="glide-logo" id="glide-logo">i</div>
            </div>
            
            <!-- Sheet -->
            <div class="sheet">
              <div class="sheet-header">
                <div class="sheet-icon">
                  <svg width="10" height="10" viewBox="0 0 24 24" fill="#0d7a3f"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14H6v-2h6v2zm4-4H6v-2h10v2zm0-4H6V7h10v2z"/></svg>
                </div>
                <span class="sheet-title">Recettes 2026</span>
              </div>
              <table class="sheet-grid w-full">
                <thead>
                  <tr><th>Date</th><th>Type</th><th>â‚¬</th></tr>
                </thead>
                <tbody id="spreadsheet-body">
                  <tr><td>08/01</td><td>CB</td><td class="amount">980</td></tr>
                  <tr><td>08/01</td><td>ESP</td><td class="amount">220</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Mobile: Simple explanation -->
      <div class="mt-16 text-center lg:hidden">
        <div class="glass-card p-6 max-w-sm mx-auto">
          <div class="flex items-center justify-center gap-4 mb-4">
            <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500/20 to-blue-500/10 flex items-center justify-center text-2xl">ðŸ“±</div>
            <span class="text-2xl">â†’</span>
            <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-green-500/20 to-green-500/10 flex items-center justify-center text-2xl">ðŸ“Š</div>
          </div>
          <p class="text-white/60 text-sm">Telegram envoie tes donnÃ©es â†’ Google Sheets les reÃ§oit automatiquement</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Modal -->
  <div class="modal-backdrop" id="modal-backdrop" onclick="closeModal()"></div>
  <div class="modal-content" id="modal-content">
    <div class="modal-close" onclick="closeModal()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
    </div>
    <div class="tab-container">
      <button class="tab-btn active" id="tab-login" onclick="switchTab('login')">Connexion</button>
      <button class="tab-btn" id="tab-register" onclick="switchTab('register')">Inscription</button>
    </div>
    <div id="login-form">
      <div class="error-msg mb-4" id="login-error"></div>
      <form onsubmit="handleLogin(event)">
        <input type="email" id="login-email" class="input-field mb-3" placeholder="Email" required>
        <input type="password" id="login-password" class="input-field mb-4" placeholder="Mot de passe" required>
        <button type="submit" class="btn-primary w-full" id="login-btn">Se connecter</button>
      </form>
      <p class="text-center mt-4">
        <a href="reset-password.html" class="text-white/40 hover:text-white text-sm">Mot de passe oubliÃ© ?</a>
      </p>
    </div>
    <div id="register-form" class="hidden">
      <div class="error-msg mb-4" id="register-error"></div>
      <form onsubmit="handleRegister(event)">
        <input type="text" id="register-name" class="input-field mb-3" placeholder="Nom complet" required>
        <input type="email" id="register-email" class="input-field mb-3" placeholder="Email" required>
        <input type="password" id="register-password" class="input-field mb-4" placeholder="Mot de passe (6 car. min)" required minlength="6">
        <button type="submit" class="btn-primary w-full" id="register-btn">CrÃ©er mon compte</button>
      </form>
    </div>
  </div>

  <script>
    const SUPABASE_URL = 'https://byqfnpdcnifauhwgetcq.supabase.co';
    const SUPABASE_ANON_KEY = 'sb_publishable_8mpFx9ubrV29KfKtgAb3eg_dyazidfT';
    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    let currentUser = null;

    // Demo animation
    function runDemo() {
      const container = document.getElementById('telegram-messages');
      const typing = document.getElementById('typing');
      const glideLogo = document.getElementById('glide-logo');
      const spreadsheet = document.getElementById('spreadsheet-body');
      
      container.querySelectorAll('.msg').forEach(m => m.remove());
      document.querySelectorAll('.new-row').forEach(r => r.remove());
      glideLogo?.classList.remove('animate');
      
      setTimeout(() => {
        const msg1 = document.createElement('div');
        msg1.className = 'msg msg-user';
        msg1.textContent = 'cb 1200 esp 350';
        container.insertBefore(msg1, typing);
        setTimeout(() => msg1.classList.add('show'), 50);
      }, 500);
      
      setTimeout(() => typing.classList.add('show'), 1200);
      setTimeout(() => glideLogo?.classList.add('animate'), 1500);
      
      setTimeout(() => {
        typing.classList.remove('show');
        const msg2 = document.createElement('div');
        msg2.className = 'msg msg-bot';
        msg2.innerHTML = 'âœ… NotÃ© !<br>CB: 1 200â‚¬<br>ESP: 350â‚¬';
        container.insertBefore(msg2, typing);
        setTimeout(() => msg2.classList.add('show'), 50);
      }, 2500);
      
      setTimeout(() => {
        const row1 = document.createElement('tr');
        row1.className = 'new-row';
        row1.innerHTML = '<td>09/01</td><td>CB</td><td class="amount">1200</td>';
        spreadsheet?.appendChild(row1);
        setTimeout(() => {
          const row2 = document.createElement('tr');
          row2.className = 'new-row';
          row2.innerHTML = '<td>09/01</td><td>ESP</td><td class="amount">350</td>';
          spreadsheet?.appendChild(row2);
        }, 300);
      }, 2800);
    }
    
    setTimeout(runDemo, 1000);
    setInterval(runDemo, 8000);

    function launchRobot() {
      window.location.href = 'compta.html';
    }

    async function checkAuth() {
      const { data: { user } } = await supabaseClient.auth.getUser();
      currentUser = user;
      updateAuthButtons();
      if (window.location.hash.includes('access_token')) window.location.href = 'compte.html';
    }

    function updateAuthButtons() {
      const c = document.getElementById('auth-buttons');
      c.innerHTML = currentUser 
        ? `<a href="compte.html" class="btn-primary text-sm px-6 py-2.5">Mon espace</a>`
        : `<button onclick="openModal('login')" class="btn-secondary text-sm px-5 py-2.5 mr-2 hidden sm:inline-block">Connexion</button><button onclick="openModal('register')" class="btn-primary text-sm px-5 py-2.5">Inscription</button>`;
    }

    function openModal(tab = 'login') {
      document.getElementById('modal-backdrop').classList.add('active');
      document.getElementById('modal-content').classList.add('active');
      document.body.style.overflow = 'hidden';
      switchTab(tab);
    }

    function closeModal() {
      document.getElementById('modal-backdrop').classList.remove('active');
      document.getElementById('modal-content').classList.remove('active');
      document.body.style.overflow = '';
    }

    document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });

    function switchTab(tab) {
      document.getElementById('tab-login').classList.toggle('active', tab === 'login');
      document.getElementById('tab-register').classList.toggle('active', tab === 'register');
      document.getElementById('login-form').classList.toggle('hidden', tab !== 'login');
      document.getElementById('register-form').classList.toggle('hidden', tab !== 'register');
    }

    async function handleLogin(e) {
      e.preventDefault();
      const btn = document.getElementById('login-btn');
      const err = document.getElementById('login-error');
      err.classList.remove('show'); btn.textContent = 'Connexion...'; btn.disabled = true;
      try {
        const { error } = await supabaseClient.auth.signInWithPassword({
          email: document.getElementById('login-email').value.trim(),
          password: document.getElementById('login-password').value
        });
        if (error) throw error;
        window.location.href = 'compte.html';
      } catch (error) {
        err.textContent = error.message === 'Invalid login credentials' ? 'Email ou mot de passe incorrect' : error.message;
        err.classList.add('show'); btn.textContent = 'Se connecter'; btn.disabled = false;
      }
    }

    async function handleRegister(e) {
      e.preventDefault();
      const btn = document.getElementById('register-btn');
      const err = document.getElementById('register-error');
      err.classList.remove('show'); btn.textContent = 'CrÃ©ation...'; btn.disabled = true;
      try {
        const { data, error } = await supabaseClient.auth.signUp({
          email: document.getElementById('register-email').value.trim(),
          password: document.getElementById('register-password').value,
          options: { data: { name: document.getElementById('register-name').value.trim() } }
        });
        if (error) throw error;
        window.location.href = 'compte.html';
      } catch (error) {
        err.textContent = error.message === 'User already registered' ? 'Compte existant' : error.message;
        err.classList.add('show'); btn.textContent = 'CrÃ©er mon compte'; btn.disabled = false;
      }
    }

    checkAuth();
  </script>
</body>
</html>
