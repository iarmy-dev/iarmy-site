<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>iArmy - Une arm√©e de robots pour ton quotidien</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%23FF6B35'/><text x='50' y='68' font-family='Arial' font-size='55' font-weight='bold' fill='white' text-anchor='middle'>i</text></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Inter', sans-serif; }
    body { background: #030303; color: white; min-height: 100vh; overflow-x: hidden; }
    
    /* Liquid glass background */
    .bg-gradient-animate { background: linear-gradient(135deg, #030303 0%, #0a0508 25%, #050808 50%, #080805 75%, #030303 100%); background-size: 400% 400%; animation: gradientShift 20s ease infinite; }
    @keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
    
    /* Floating orbs */
    .orb { position: fixed; border-radius: 50%; filter: blur(100px); opacity: 0.15; animation: float 15s ease-in-out infinite; pointer-events: none; z-index: 0; }
    .orb-1 { width: 500px; height: 500px; background: linear-gradient(135deg, #FF6B35, #FF8B5E); top: -250px; right: -150px; }
    .orb-2 { width: 400px; height: 400px; background: linear-gradient(135deg, #6B35FF, #8B5EFF); bottom: -200px; left: -150px; animation-delay: -7s; }
    .orb-3 { width: 250px; height: 250px; background: linear-gradient(135deg, #35FFB8, #5EFFD4); top: 50%; left: 30%; opacity: 0.08; animation-delay: -3s; }
    @keyframes float { 0%, 100% { transform: translate(0, 0) scale(1); } 33% { transform: translate(30px, -30px) scale(1.05); } 66% { transform: translate(-20px, 20px) scale(0.95); } }
    
    /* Glass effects */
    .glass { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.05); }
    .glass-card { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px); border: 1px solid rgba(255, 255, 255, 0.06); border-radius: 24px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4); transition: all 0.4s ease; }
    .glass-card:hover { background: rgba(255, 255, 255, 0.04); border-color: rgba(255, 255, 255, 0.1); transform: translateY(-4px); }
    .glass-card-disabled { background: rgba(255, 255, 255, 0.01); backdrop-filter: blur(24px); border: 1px solid rgba(255, 255, 255, 0.03); border-radius: 20px; opacity: 0.5; }
    
    /* Logo */
    .logo-i { width: 40px; height: 40px; background: linear-gradient(135deg, #FF6B35 0%, #FF8B5E 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 20px; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); position: relative; }
    .logo-i::before { content: ''; position: absolute; inset: -4px; background: linear-gradient(135deg, #FF6B35, #FF8B5E); border-radius: 16px; opacity: 0; filter: blur(15px); transition: all 0.4s; z-index: -1; }
    .logo-i:hover { transform: scale(1.15) rotate(-8deg); box-shadow: 0 0 40px rgba(255,107,53,0.6); }
    .logo-i:hover::before { opacity: 1; }
    
    /* Buttons */
    .btn-primary { background: linear-gradient(135deg, #FF6B35 0%, #FF8B5E 100%); padding: 14px 28px; border-radius: 14px; font-weight: 600; transition: all 0.3s; border: none; color: white; cursor: pointer; position: relative; overflow: hidden; }
    .btn-primary::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition: left 0.5s ease; }
    .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 15px 40px rgba(255,107,53,0.4); }
    .btn-primary:hover::before { left: 100%; }
    
    .btn-secondary { background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08); padding: 12px 24px; border-radius: 12px; font-weight: 500; transition: all 0.3s; color: white; cursor: pointer; }
    .btn-secondary:hover { background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.15); }
    
    /* Animations */
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes floatY { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
    @keyframes glide { 0% { left: 0; opacity: 0; transform: translateY(-50%) scale(0.5); } 15% { opacity: 1; transform: translateY(-50%) scale(1); } 85% { opacity: 1; transform: translateY(-50%) scale(1); } 100% { left: calc(100% - 36px); opacity: 0; transform: translateY(-50%) scale(0.5); } }
    @keyframes rowHighlight { 0% { background: rgba(255,107,53,0.4); } 100% { background: transparent; } }
    @keyframes typing { 0%, 60%, 100% { opacity: 0.3; } 30% { opacity: 1; } }
    @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
    
    .animate-fade-in-up { animation: fadeInUp 0.6s ease-out forwards; }
    .animate-fade-in-down { animation: fadeInDown 0.5s ease-out forwards; }
    .animate-float { animation: floatY 4s ease-in-out infinite; }
    .delay-100 { animation-delay: 0.1s; opacity: 0; }
    .delay-200 { animation-delay: 0.2s; opacity: 0; }
    .delay-300 { animation-delay: 0.3s; opacity: 0; }
    .delay-400 { animation-delay: 0.4s; opacity: 0; }
    
    /* iPhone */
    .iphone { width: 220px; background: linear-gradient(145deg, #2a2a2a, #1a1a1a); border-radius: 36px; padding: 10px; box-shadow: 0 0 0 2px rgba(255,255,255,0.1), 0 30px 60px rgba(0,0,0,0.5), inset 0 1px 1px rgba(255,255,255,0.1); }
    .iphone-screen { background: #000; border-radius: 28px; overflow: hidden; }
    .iphone-notch { width: 90px; height: 24px; background: #000; border-radius: 0 0 16px 16px; margin: 0 auto; position: relative; }
    .iphone-notch::after { content: ''; position: absolute; width: 8px; height: 8px; background: #1a1a1a; border-radius: 50%; top: 8px; right: 20px; }
    
    /* Telegram */
    .telegram-header { background: #1c1c1e; padding: 8px 12px; display: flex; align-items: center; gap: 10px; }
    .telegram-back { color: #0a84ff; font-size: 20px; }
    .telegram-avatar { width: 30px; height: 30px; background: linear-gradient(135deg, #FF6B35, #FF8B5E); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 12px; }
    .telegram-name { font-size: 14px; font-weight: 600; }
    .telegram-status { font-size: 11px; color: #0a84ff; }
    .telegram-messages { background: #000; padding: 12px; min-height: 180px; display: flex; flex-direction: column; gap: 8px; }
    .msg { max-width: 80%; padding: 8px 12px; border-radius: 18px; font-size: 13px; line-height: 1.3; opacity: 0; transform: translateY(10px); transition: all 0.3s; }
    .msg.show { opacity: 1; transform: translateY(0); }
    .msg-user { background: #0a84ff; align-self: flex-end; border-bottom-right-radius: 4px; }
    .msg-bot { background: #2c2c2e; align-self: flex-start; border-bottom-left-radius: 4px; }
    .typing-indicator { display: flex; gap: 4px; padding: 12px 14px; background: #2c2c2e; border-radius: 18px; align-self: flex-start; opacity: 0; transition: opacity 0.2s; }
    .typing-indicator.show { opacity: 1; }
    .typing-indicator span { width: 6px; height: 6px; background: #666; border-radius: 50%; animation: typing 1.4s infinite; }
    .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
    .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
    
    /* Glide */
    .glide-container { position: relative; width: 120px; height: 40px; }
    .glide-line { position: absolute; top: 50%; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, rgba(255,107,53,0.1), rgba(255,107,53,0.3), rgba(255,107,53,0.1)); }
    .glide-logo { position: absolute; top: 50%; left: 0; transform: translateY(-50%); width: 36px; height: 36px; background: linear-gradient(135deg, #FF6B35, #FF8B5E); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 16px; opacity: 0; box-shadow: 0 0 30px rgba(255,107,53,0.6); }
    .glide-logo.animate { animation: glide 1.5s ease-in-out forwards; }
    
    /* Sheet */
    .sheet { width: 200px; background: rgba(26, 26, 26, 0.8); backdrop-filter: blur(10px); border-radius: 16px; overflow: hidden; box-shadow: 0 20px 60px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.05); }
    .sheet-header { background: #0d7a3f; padding: 10px 14px; display: flex; align-items: center; gap: 8px; }
    .sheet-icon { width: 20px; height: 20px; background: white; border-radius: 4px; display: flex; align-items: center; justify-content: center; }
    .sheet-title { font-size: 13px; font-weight: 500; }
    .sheet-grid { font-size: 12px; }
    .sheet-grid th, .sheet-grid td { padding: 8px 12px; border: 1px solid rgba(255,255,255,0.08); text-align: left; }
    .sheet-grid th { background: rgba(255,255,255,0.03); font-weight: 500; color: rgba(255,255,255,0.5); }
    .sheet-grid .amount { color: #4ade80; font-weight: 600; }
    .new-row { animation: rowHighlight 1s ease-out; }
    
    /* Modal */
    .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(8px); z-index: 100; opacity: 0; pointer-events: none; transition: opacity 0.3s; }
    .modal-backdrop.active { opacity: 1; pointer-events: all; }
    .modal-content { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95); background: rgba(17, 17, 17, 0.95); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); border-radius: 24px; padding: 32px; width: 90%; max-width: 400px; z-index: 101; opacity: 0; pointer-events: none; transition: all 0.3s; }
    .modal-content.active { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: all; }
    .modal-close { position: absolute; top: 16px; right: 16px; width: 32px; height: 32px; background: rgba(255,255,255,0.05); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s; }
    .modal-close:hover { background: rgba(255,255,255,0.1); transform: rotate(90deg); }
    
    .input-field { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 14px 16px; color: white; width: 100%; font-size: 15px; transition: all 0.2s; }
    .input-field:focus { outline: none; border-color: rgba(255,107,53,0.5); box-shadow: 0 0 0 3px rgba(255,107,53,0.1); }
    .input-field::placeholder { color: rgba(255,255,255,0.3); }
    
    .tab-container { display: flex; background: rgba(255,255,255,0.05); border-radius: 12px; padding: 4px; margin-bottom: 24px; }
    .tab-btn { flex: 1; padding: 10px; border-radius: 10px; font-size: 14px; font-weight: 500; color: rgba(255,255,255,0.5); background: transparent; border: none; cursor: pointer; transition: all 0.2s; }
    .tab-btn.active { background: rgba(255,107,53,0.2); color: #FF6B35; }
    
    .error-msg { background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.2); border-radius: 10px; padding: 10px 14px; color: #ef4444; font-size: 13px; display: none; }
    .error-msg.show { display: block; }
    
    /* Robot card */
    .robot-icon { width: 56px; height: 56px; border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 28px; }
    .robot-icon-active { background: linear-gradient(135deg, rgba(255,107,53,0.2), rgba(255,107,53,0.1)); box-shadow: 0 0 30px rgba(255,107,53,0.2); }
    .robot-icon-disabled { background: rgba(255,255,255,0.03); }
    
    /* Badge */
    .badge { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
    .badge-active { background: rgba(34,197,94,0.15); color: #4ade80; border: 1px solid rgba(34,197,94,0.3); }
    .badge-coming { background: rgba(255,255,255,0.05); color: rgba(255,255,255,0.4); border: 1px solid rgba(255,255,255,0.1); }
    
    /* Footer */
    footer { background: rgba(0,0,0,0.3); border-top: 1px solid rgba(255,255,255,0.05); }
    footer a { color: rgba(255,255,255,0.4); transition: color 0.2s; }
    footer a:hover { color: white; }
    
    @media (max-width: 768px) {
      .hero-demo { flex-direction: column; align-items: center; gap: 16px; }
      .iphone { width: 180px; }
      .sheet { width: 180px; }
      .glide-container { transform: rotate(90deg); height: 60px; }
      .orb { opacity: 0.1; }
    }
  </style>
</head>
<body class="bg-gradient-animate">
  <!-- Orbs -->
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>

  <!-- Nav -->
  <nav class="glass fixed top-0 left-0 right-0 z-50 animate-fade-in-down">
    <div class="max-w-6xl mx-auto px-6 py-4 flex items-center justify-between">
      <a href="index.html" class="flex items-center gap-3">
        <div class="logo-i">i</div>
        <span class="font-semibold text-lg">iArmy</span>
      </a>
      <div id="auth-buttons"></div>
    </div>
  </nav>

  <!-- Hero -->
  <section class="min-h-screen flex items-center justify-center px-6 pt-20 relative z-10">
    <div class="max-w-6xl mx-auto text-center">
      <h1 class="text-4xl sm:text-5xl md:text-6xl font-bold mb-4 animate-fade-in-up">
        Une arm√©e de robots<br>pour ton <span class="text-orange-500">quotidien</span>
      </h1>
      <p class="text-lg md:text-xl text-white/50 mb-12 animate-fade-in-up delay-100">
        Gagne du temps. On s'occupe du reste.
      </p>
      
      <!-- Demo -->
      <div class="hero-demo flex items-center justify-center gap-8 mb-12 animate-fade-in-up delay-200">
        <!-- iPhone -->
        <div class="iphone animate-float">
          <div class="iphone-screen">
            <div class="iphone-notch"></div>
            <div class="telegram-header">
              <span class="telegram-back">‚Äπ</span>
              <div class="telegram-avatar">i</div>
              <div class="text-left">
                <div class="telegram-name">iArmy Bot</div>
                <div class="telegram-status">en ligne</div>
              </div>
            </div>
            <div class="telegram-messages" id="telegram-messages">
              <div class="typing-indicator" id="typing">
                <span></span><span></span><span></span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Glide -->
        <div class="glide-container hidden md:block">
          <div class="glide-line"></div>
          <div class="glide-logo" id="glide-logo">i</div>
        </div>
        
        <!-- Sheet -->
        <div class="sheet animate-float" style="animation-delay: -2s;">
          <div class="sheet-header">
            <div class="sheet-icon">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="#0d7a3f"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14H6v-2h6v2zm4-4H6v-2h10v2zm0-4H6V7h10v2z"/></svg>
            </div>
            <span class="sheet-title">Compta 2026</span>
          </div>
          <table class="sheet-grid w-full">
            <thead><tr><th>Date</th><th>Type</th><th>‚Ç¨</th></tr></thead>
            <tbody id="spreadsheet-body">
              <tr><td>08/01</td><td>CB</td><td class="amount">850</td></tr>
              <tr><td>08/01</td><td>ESP</td><td class="amount">120</td></tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <div class="animate-fade-in-up delay-300">
        <button onclick="launchRobot()" class="btn-primary text-lg px-10 py-4">
          Lancer mon robot ‚Üí
        </button>
        <p class="text-white/30 text-sm mt-4">7 jours d'essai gratuit</p>
      </div>
    </div>
  </section>

  <!-- L'arm√©e -->
  <section class="py-20 px-6 relative z-10">
    <div class="max-w-4xl mx-auto">
      
      <!-- Premier soldat -->
      <div class="text-center mb-8">
        <span class="text-white/30 text-sm uppercase tracking-widest">üéñÔ∏è Ton premier soldat</span>
      </div>
      
      <div class="glass-card p-6 md:p-8 mb-16 border-orange-500/20 animate-fade-in-up">
        <div class="flex flex-col md:flex-row items-center gap-6">
          <div class="robot-icon robot-icon-active">üßæ</div>
          <div class="text-center md:text-left flex-1">
            <div class="flex items-center justify-center md:justify-start gap-3 mb-2">
              <h3 class="text-xl font-bold">Compta Express</h3>
              <span class="badge badge-active">Disponible</span>
            </div>
            <p class="text-white/50">Envoie tes recettes sur Telegram ‚Üí Le robot remplit ton Google Sheet automatiquement. Id√©al pour les restaurants.</p>
          </div>
          <button onclick="launchRobot()" class="btn-primary whitespace-nowrap">Configurer ‚Üí</button>
        </div>
      </div>
      
      <!-- Renforts -->
      <div class="text-center mb-8">
        <span class="text-white/30 text-sm uppercase tracking-widest">üöÄ Renforts en approche...</span>
      </div>
      
      <div class="grid md:grid-cols-3 gap-4">
        <div class="glass-card-disabled p-5 text-center">
          <div class="robot-icon robot-icon-disabled mx-auto mb-3">üìã</div>
          <h4 class="font-semibold mb-1">Task Manager</h4>
          <span class="badge badge-coming">Bient√¥t</span>
        </div>
        <div class="glass-card-disabled p-5 text-center">
          <div class="robot-icon robot-icon-disabled mx-auto mb-3">üìä</div>
          <h4 class="font-semibold mb-1">Analytics</h4>
          <span class="badge badge-coming">Bient√¥t</span>
        </div>
        <div class="glass-card-disabled p-5 text-center">
          <div class="robot-icon robot-icon-disabled mx-auto mb-3">ü§ñ</div>
          <h4 class="font-semibold mb-1">Assistant IA</h4>
          <span class="badge badge-coming">Bient√¥t</span>
        </div>
      </div>
      
    </div>
  </section>

  <!-- Footer -->
  <footer class="py-10 px-6 relative z-10">
    <div class="max-w-4xl mx-auto">
      <div class="flex flex-col md:flex-row items-center justify-between gap-6">
        <a href="index.html" class="flex items-center gap-3">
          <div class="logo-i" style="width:32px;height:32px;font-size:16px;border-radius:10px;">i</div>
          <span class="font-semibold text-white/60">iArmy</span>
        </a>
        <div class="flex items-center gap-6 text-sm">
          <a href="index.html">Accueil</a>
          <a href="compte.html">Mon compte</a>
          <a href="mailto:contact@iarmy.fr">Contact</a>
        </div>
        <p class="text-white/30 text-sm">¬© 2026 iArmy</p>
      </div>
    </div>
  </footer>

  <!-- Modal -->
  <div class="modal-backdrop" id="modal-backdrop" onclick="closeModal()"></div>
  <div class="modal-content" id="modal-content">
    <div class="modal-close" onclick="closeModal()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
    </div>
    <div class="tab-container">
      <button class="tab-btn active" id="tab-login" onclick="switchTab('login')">Connexion</button>
      <button class="tab-btn" id="tab-register" onclick="switchTab('register')">Inscription</button>
    </div>
    <div id="login-form">
      <div class="error-msg mb-4" id="login-error"></div>
      <form onsubmit="handleLogin(event)">
        <input type="email" id="login-email" class="input-field mb-3" placeholder="Email" required>
        <input type="password" id="login-password" class="input-field mb-4" placeholder="Mot de passe" required>
        <button type="submit" class="btn-primary w-full" id="login-btn">Se connecter</button>
      </form>
      <p class="text-center mt-4"><a href="reset-password.html" class="text-white/40 hover:text-white text-sm">Mot de passe oubli√© ?</a></p>
    </div>
    <div id="register-form" class="hidden">
      <div class="error-msg mb-4" id="register-error"></div>
      <form onsubmit="handleRegister(event)">
        <input type="text" id="register-name" class="input-field mb-3" placeholder="Nom complet" required>
        <input type="email" id="register-email" class="input-field mb-3" placeholder="Email" required>
        <input type="password" id="register-password" class="input-field mb-4" placeholder="Mot de passe (6 car. min)" required minlength="6">
        <button type="submit" class="btn-primary w-full" id="register-btn">Cr√©er mon compte</button>
      </form>
    </div>
  </div>

  <script>
    const SUPABASE_URL = 'https://byqfnpdcnifauhwgetcq.supabase.co';
    const SUPABASE_ANON_KEY = 'sb_publishable_8mpFx9ubrV29KfKtgAb3eg_dyazidfT';
    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    let currentUser = null;

    function runDemo() {
      const container = document.getElementById('telegram-messages');
      const typing = document.getElementById('typing');
      const glideLogo = document.getElementById('glide-logo');
      const spreadsheet = document.getElementById('spreadsheet-body');
      
      container.querySelectorAll('.msg').forEach(m => m.remove());
      document.querySelectorAll('.new-row').forEach(r => r.remove());
      glideLogo?.classList.remove('animate');
      
      setTimeout(() => {
        const msg1 = document.createElement('div');
        msg1.className = 'msg msg-user';
        msg1.textContent = 'cb 1200 esp 350';
        container.insertBefore(msg1, typing);
        setTimeout(() => msg1.classList.add('show'), 50);
      }, 500);
      
      setTimeout(() => typing.classList.add('show'), 1200);
      setTimeout(() => glideLogo?.classList.add('animate'), 1500);
      
      setTimeout(() => {
        typing.classList.remove('show');
        const msg2 = document.createElement('div');
        msg2.className = 'msg msg-bot';
        msg2.innerHTML = '‚úÖ Not√© !<br>CB: 1 200‚Ç¨<br>Esp√®ces: 350‚Ç¨';
        container.insertBefore(msg2, typing);
        setTimeout(() => msg2.classList.add('show'), 50);
      }, 2500);
      
      setTimeout(() => {
        const row1 = document.createElement('tr');
        row1.className = 'new-row';
        row1.innerHTML = '<td>09/01</td><td>CB</td><td class="amount">1 200</td>';
        spreadsheet?.appendChild(row1);
        setTimeout(() => {
          const row2 = document.createElement('tr');
          row2.className = 'new-row';
          row2.innerHTML = '<td>09/01</td><td>ESP</td><td class="amount">350</td>';
          spreadsheet?.appendChild(row2);
        }, 300);
      }, 2800);
    }
    
    setTimeout(runDemo, 1000);
    setInterval(runDemo, 8000);

    function launchRobot() { window.location.href = 'compta.html'; }

    async function checkAuth() {
      const { data: { user } } = await supabaseClient.auth.getUser();
      currentUser = user;
      updateAuthButtons();
      if (window.location.hash.includes('access_token')) window.location.href = 'compte.html';
    }

    function updateAuthButtons() {
      const c = document.getElementById('auth-buttons');
      c.innerHTML = currentUser 
        ? `<a href="compte.html" class="btn-primary text-sm px-6 py-2.5">Mon espace</a>`
        : `<button onclick="openModal('login')" class="btn-secondary text-sm px-5 py-2.5 mr-2 hidden sm:inline-block">Connexion</button><button onclick="openModal('register')" class="btn-primary text-sm px-5 py-2.5">Inscription</button>`;
    }

    function openModal(tab = 'login') {
      document.getElementById('modal-backdrop').classList.add('active');
      document.getElementById('modal-content').classList.add('active');
      document.body.style.overflow = 'hidden';
      switchTab(tab);
    }

    function closeModal() {
      document.getElementById('modal-backdrop').classList.remove('active');
      document.getElementById('modal-content').classList.remove('active');
      document.body.style.overflow = '';
    }

    document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });

    function switchTab(tab) {
      document.getElementById('tab-login').classList.toggle('active', tab === 'login');
      document.getElementById('tab-register').classList.toggle('active', tab === 'register');
      document.getElementById('login-form').classList.toggle('hidden', tab !== 'login');
      document.getElementById('register-form').classList.toggle('hidden', tab !== 'register');
    }

    async function handleLogin(e) {
      e.preventDefault();
      const btn = document.getElementById('login-btn');
      const err = document.getElementById('login-error');
      err.classList.remove('show'); btn.textContent = 'Connexion...'; btn.disabled = true;
      try {
        const { error } = await supabaseClient.auth.signInWithPassword({
          email: document.getElementById('login-email').value.trim(),
          password: document.getElementById('login-password').value
        });
        if (error) throw error;
        window.location.href = 'compte.html';
      } catch (error) {
        err.textContent = error.message === 'Invalid login credentials' ? 'Email ou mot de passe incorrect' : error.message;
        err.classList.add('show'); btn.textContent = 'Se connecter'; btn.disabled = false;
      }
    }

    async function handleRegister(e) {
      e.preventDefault();
      const btn = document.getElementById('register-btn');
      const err = document.getElementById('register-error');
      err.classList.remove('show'); btn.textContent = 'Cr√©ation...'; btn.disabled = true;
      try {
        const { data, error } = await supabaseClient.auth.signUp({
          email: document.getElementById('register-email').value.trim(),
          password: document.getElementById('register-password').value,
          options: { data: { name: document.getElementById('register-name').value.trim() } }
        });
        if (error) throw error;
        window.location.href = 'compte.html';
      } catch (error) {
        err.textContent = error.message === 'User already registered' ? 'Compte existant' : error.message;
        err.classList.add('show'); btn.textContent = 'Cr√©er mon compte'; btn.disabled = false;
      }
    }

    checkAuth();
  </script>
</body>
</html>
